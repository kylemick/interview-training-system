# Capability: Question Bank (题库管理)

## ADDED Requirements

### Requirement: 题目数据模型
系统SHALL定义标准化的题目数据结构，支持七大专项类别。

#### Scenario: 存储题目元数据
- **WHEN** 系统创建或导入题目
- **THEN** 每道题目包含：唯一ID、专项类别、难度等级、学校标签、题目文本、参考答案、评分标准
- **AND** 可选字段：创建时间、来源（手动/AI生成）、使用次数、平均得分

#### Scenario: 七大专项类别定义
- **WHEN** 系统初始化题库
- **THEN** 支持以下类别：`english-oral`（英文口语）、`chinese-oral`（中文表达）、`logic-thinking`（逻辑思维）、`current-affairs`（时事常识）、`science-knowledge`（科学常识）、`personal-growth`（个人成长）、`group-discussion`（小组讨论）
- **AND** 每个类别有清晰的描述和示例题目

### Requirement: 题目录入和导入
系统SHALL支持手动录入和批量导入题目。

#### Scenario: 手动添加单个题目
- **WHEN** 用户通过CLI添加题目，提供类别、难度、题目文本
- **THEN** 系统验证输入（类别合法、难度在1-5范围）
- **AND** 生成唯一ID并保存到数据库
- **AND** 返回成功消息和题目ID

#### Scenario: 批量导入JSON格式题目
- **WHEN** 用户导入包含题目数组的JSON文件
- **THEN** 系统验证每个题目的格式和必填字段
- **AND** 跳过无效题目并记录错误
- **AND** 成功导入的题目保存到数据库
- **AND** 返回导入统计（成功数、失败数）

#### Scenario: 导入面试回忆文本
- **WHEN** 用户粘贴面试回忆文本（已经用外部工具转好的文字）
- **THEN** 用户标注专项类别和学校
- **AND** 可选：用户手动拆分为多个问答对，或AI辅助识别问答对
- **AND** 系统将每个问答对保存为题目（题目文本+用户的原始回答）
- **AND** 标记为"面试回忆"来源

### Requirement: 题目查询和筛选
系统SHALL提供灵活的题目查询功能。

#### Scenario: 按类别查询题目
- **WHEN** 用户查询特定类别的题目（如"english-oral"）
- **THEN** 返回该类别的所有题目列表
- **AND** 显示每题的ID、难度、简短文本预览

#### Scenario: 按学校标签筛选
- **WHEN** 用户指定目标学校（如"SPCC"）查询题目
- **THEN** 返回标记为该学校相关或适用于该校的题目
- **AND** 优先显示该校真题或高相关题目

#### Scenario: 按难度筛选
- **WHEN** 用户指定难度范围（如"3-5"）查询题目
- **THEN** 返回难度在该范围内的题目
- **AND** 可结合类别和学校标签进行多条件筛选

#### Scenario: 随机选题
- **WHEN** 系统需要为练习会话选择题目
- **THEN** 根据筛选条件（类别、难度、学校）随机选择题目
- **AND** 避免短期内重复（如最近10次会话未使用）
- **AND** 优先选择用户表现较弱的子类别题目

### Requirement: AI生成题目
系统SHALL使用AI生成题目以扩充题库，并支持从面试回忆中提取题目。

#### Scenario: 生成指定类别题目
- **WHEN** 用户请求生成N道指定类别的题目（如"生成15道时事常识题"）
- **THEN** 系统调用AI API，提供类别、难度、学校上下文
- **AND** AI返回题目列表（JSON格式），包含题目文本、参考答案、评分标准
- **AND** 系统验证并保存生成的题目，标注来源为"AI生成"

#### Scenario: 根据热点时事生成题目
- **WHEN** 用户请求生成时事常识题
- **THEN** 系统在提示词中要求AI基于近期热点事件（可选：提供时事关键词）
- **AND** AI生成与时事相关的面试题目
- **AND** 题目包含对时事的理解和个人观点阐述要求

#### Scenario: 从面试回忆中AI提取题目
- **WHEN** 用户提交面试回忆文本并请求AI分析
- **THEN** AI识别文本中的问答对结构
- **AND** AI提取问题、学生回答、可能的面试官追问
- **AND** AI推断题目的专项类别和难度
- **AND** 将提取的题目保存到题库，标记为"面试回忆提取"

### Requirement: 题目质量管理
系统SHALL支持题目的评价、编辑和删除。

#### Scenario: 编辑题目内容
- **WHEN** 用户发现题目有误或需要优化
- **THEN** 用户可编辑题目的任意字段（文本、难度、标签等）
- **AND** 系统保存修改历史（修改时间、修改人）
- **AND** 已使用该题的历史会话保留原题目快照

#### Scenario: 标记题目质量
- **WHEN** 用户或系统评估题目质量
- **THEN** 可对题目标记质量标签（优秀/良好/需改进）
- **AND** 选题时优先选择"优秀"和"良好"题目
- **AND** "需改进"题目不自动选用，仅供手动查看和修正

#### Scenario: 删除低质量题目
- **WHEN** 用户删除题目
- **THEN** 系统标记题目为"已删除"而非物理删除
- **AND** 历史会话中的该题记录保留但注明"题目已下架"
- **AND** 删除的题目不再出现在选题池中

### Requirement: 题目统计和分析
系统SHALL收集题目使用数据以优化题库。

#### Scenario: 统计题目使用频率
- **WHEN** 查看题库统计数据
- **THEN** 显示每道题的使用次数、最后使用时间
- **AND** 识别长期未使用的题目（如>30天未使用）
- **AND** 建议补充或生成新题

#### Scenario: 统计题目平均表现
- **WHEN** 题目被使用多次后
- **THEN** 计算该题的平均得分和答题时长
- **AND** 识别过难（平均分<50%）或过易（平均分>90%）的题目
- **AND** 建议调整难度标签或题目内容
