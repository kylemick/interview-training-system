# Capability: Interview Practice (面试练习)

## MODIFIED Requirements

### Requirement: 文字问答模式
系统SHALL支持用户通过文字输入或语音输入回答问题。

#### Scenario: 提交文字答案
- **WHEN** 用户输入答案文字并提交
- **THEN** 系统保存问答记录（题目ID、问题文本、学生答案、时间戳）
- **AND** 提示是否查看即时反馈或继续下一题

#### Scenario: 提交语音答案
- **WHEN** 用户点击语音输入按钮并开始录音
- **THEN** 系统启动语音识别（支持中文、英文）
- **AND** 实时显示识别结果
- **AND** 识别完成后自动填充到文本输入框
- **AND** 用户可编辑识别结果后提交
- **AND** 系统保存问答记录（与文字答案相同格式）

#### Scenario: 语音输入语言选择
- **WHEN** 用户首次使用语音输入或需要切换语言
- **THEN** 系统显示语言选择器（中文/英文）
- **AND** 根据用户选择设置识别语言
- **AND** 保存用户语言偏好（可选）

#### Scenario: 语音识别错误处理
- **WHEN** 语音识别失败（网络错误、权限拒绝、识别超时）
- **THEN** 系统显示错误提示
- **AND** 允许用户重试或切换回文本输入
- **AND** 不影响现有文本输入功能

#### Scenario: 模型加载失败处理
- **WHEN** 语音识别模型文件不存在或加载失败
- **THEN** 系统显示清晰的错误提示（包含错误原因和解决方案）
- **AND** 提供模型文件下载链接或配置说明
- **AND** 提供重试按钮，允许用户重新尝试加载
- **AND** 如果重试失败，自动隐藏语音输入按钮，降级到文本输入
- **AND** 确保文本输入功能始终可用，不影响用户继续练习

#### Scenario: 模型路径配置错误处理
- **WHEN** 模型路径配置错误（如指向压缩文件而非解压目录）
- **THEN** 系统检测到路径错误并显示配置提示
- **AND** 提供正确的路径配置说明
- **AND** 允许用户通过配置修复问题

#### Scenario: 浏览器兼容性处理
- **WHEN** 用户使用的浏览器不支持语音识别API或WebAssembly
- **THEN** 系统自动隐藏语音输入按钮
- **AND** 仅显示文本输入功能
- **AND** 不显示错误提示（降级处理）

#### Scenario: 跳过题目
- **WHEN** 用户选择跳过当前题目
- **THEN** 系统标记该题为"已跳过"但保留记录
- **AND** 展示下一题

## MODIFIED Requirements

### Requirement: 语音输入功能
系统SHALL提供语音输入功能，允许用户通过说话的方式输入答案，系统自动将语音转换为文本。

#### Scenario: 启动语音输入
- **WHEN** 用户点击"语音输入"按钮
- **THEN** 系统检查模型文件是否存在
- **AND** 如果模型文件存在，请求麦克风权限（如未授权）
- **AND** 开始录音并显示录音状态指示
- **AND** 显示录音时长
- **AND** 如果模型文件不存在，显示错误提示并提供解决方案

#### Scenario: 模型加载
- **WHEN** 系统需要加载语音识别模型
- **THEN** 系统首先检查模型文件是否存在
- **AND** 如果文件不存在，显示清晰的错误提示（包含文件路径和下载说明）
- **AND** 如果文件存在，开始加载模型并显示加载进度
- **AND** 加载失败时，区分错误类型（文件不存在、网络错误、格式错误等）并显示相应提示
- **AND** 提供重试机制，允许用户重新尝试加载

#### Scenario: 实时语音识别
- **WHEN** 用户正在录音
- **THEN** 系统实时显示识别中间结果（如果API支持）
- **AND** 提供视觉反馈（录音中动画、识别中提示）

#### Scenario: 停止录音并识别
- **WHEN** 用户点击停止录音按钮
- **THEN** 系统停止录音并开始识别处理
- **AND** 显示"识别中"状态
- **AND** 识别完成后显示最终结果

#### Scenario: 识别结果处理
- **WHEN** 语音识别完成
- **THEN** 系统自动将识别结果填充到文本输入框
- **AND** 允许用户手动编辑识别结果
- **AND** 支持多次录音追加或替换内容

#### Scenario: 输入方式切换
- **WHEN** 用户在使用语音输入或文本输入
- **THEN** 系统允许用户随时切换输入方式
- **AND** 两种输入方式的结果可以合并编辑
- **AND** 保持输入框内容同步

#### Scenario: 错误恢复和降级
- **WHEN** 语音输入功能因任何原因无法使用（模型加载失败、浏览器不支持等）
- **THEN** 系统自动隐藏语音输入按钮
- **AND** 显示友好的提示信息，说明语音输入暂时不可用
- **AND** 引导用户使用文本输入功能
- **AND** 确保所有错误都被正确捕获，不会导致页面崩溃或服务重启
- **AND** 记录错误日志，便于问题排查和修复
