# Capability: Interview Practice (面試練習)

## MODIFIED Requirements

### Requirement: 文字問答模式
係統SHALL支持用户通過文字输入或語音输入回答問題。

#### Scenario: 提交文字答案
- **WHEN** 用户输入答案文字并提交
- **THEN** 係統保存問答記錄（題目ID、問題文本、學生答案、時間戳）
- **AND** 提示是否查看即時反馈或继续下一題

#### Scenario: 提交語音答案
- **WHEN** 用户點击語音输入按钮并開始錄音
- **THEN** 係統启動語音識別（支持中文、英文）
- **AND** 实時显示識別結果
- **AND** 識別完成後自動填充到文本输入框
- **AND** 用户可编輯識別結果後提交
- **AND** 係統保存問答記錄（与文字答案相同格式）

#### Scenario: 語音输入語言選擇
- **WHEN** 用户首次使用語音输入或需要切换語言
- **THEN** 係統显示語言選擇器（中文/英文）
- **AND** 根據用户選擇设置識別語言
- **AND** 保存用户語言偏好（可選）

#### Scenario: 語音識別错误处理
- **WHEN** 語音識別失敗（网络错误、权限拒绝、識別超時）
- **THEN** 係統显示错误提示
- **AND** 允许用户重試或切换回文本输入
- **AND** 不影响现有文本输入功能

#### Scenario: 模型加载失敗处理
- **WHEN** 語音識別模型文件不存在或加载失敗
- **THEN** 係統显示清晰的错误提示（包含错误原因和解决方案）
- **AND** 提供模型文件下载链接或配置說明
- **AND** 提供重試按钮，允许用户重新尝試加载
- **AND** 如果重試失敗，自動隐藏語音输入按钮，降级到文本输入
- **AND** 確保文本输入功能始终可用，不影响用户继续練習

#### Scenario: 模型路径配置错误处理
- **WHEN** 模型路径配置错误（如指向压缩文件而非解压目錄）
- **THEN** 係統检测到路径错误并显示配置提示
- **AND** 提供正確的路径配置說明
- **AND** 允许用户通過配置修复問題

#### Scenario: 浏览器兼容性处理
- **WHEN** 用户使用的浏览器不支持語音識別API或WebAssembly
- **THEN** 係統自動隐藏語音输入按钮
- **AND** 仅显示文本输入功能
- **AND** 不显示错误提示（降级处理）

#### Scenario: 跳過題目
- **WHEN** 用户選擇跳過当前題目
- **THEN** 係統標記该題为"已跳過"但保留記錄
- **AND** 展示下一題

## MODIFIED Requirements

### Requirement: 語音输入功能
係統SHALL提供語音输入功能，允许用户通過說話的方式输入答案，係統自動将語音转换为文本。

#### Scenario: 启動語音输入
- **WHEN** 用户點击"語音输入"按钮
- **THEN** 係統检查模型文件是否存在
- **AND** 如果模型文件存在，请求麦克風权限（如未授权）
- **AND** 開始錄音并显示錄音狀態指示
- **AND** 显示錄音時長
- **AND** 如果模型文件不存在，显示错误提示并提供解决方案

#### Scenario: 模型加载
- **WHEN** 係統需要加载語音識別模型
- **THEN** 係統首先检查模型文件是否存在
- **AND** 如果文件不存在，显示清晰的错误提示（包含文件路径和下载說明）
- **AND** 如果文件存在，開始加载模型并显示加载進度
- **AND** 加载失敗時，区分错误類型（文件不存在、网络错误、格式错误等）并显示相应提示
- **AND** 提供重試机制，允许用户重新尝試加载

#### Scenario: 实時語音識別
- **WHEN** 用户正在錄音
- **THEN** 係統实時显示識別中間結果（如果API支持）
- **AND** 提供视觉反馈（錄音中動画、識別中提示）

#### Scenario: 停止錄音并識別
- **WHEN** 用户點击停止錄音按钮
- **THEN** 係統停止錄音并開始識別处理
- **AND** 显示"識別中"狀態
- **AND** 識別完成後显示最终結果

#### Scenario: 識別結果处理
- **WHEN** 語音識別完成
- **THEN** 係統自動将識別結果填充到文本输入框
- **AND** 允许用户手動编輯識別結果
- **AND** 支持多次錄音追加或替换內容

#### Scenario: 输入方式切换
- **WHEN** 用户在使用語音输入或文本输入
- **THEN** 係統允许用户随時切换输入方式
- **AND** 两種输入方式的結果可以合并编輯
- **AND** 保持输入框內容同步

#### Scenario: 错误恢复和降级
- **WHEN** 語音输入功能因任何原因无法使用（模型加载失敗、浏览器不支持等）
- **THEN** 係統自動隐藏語音输入按钮
- **AND** 显示友好的提示信息，說明語音输入暫時不可用
- **AND** 引導用户使用文本输入功能
- **AND** 確保所有错误都被正確捕获，不會導致页面崩溃或服務重启
- **AND** 記錄错误日志，便于問題排查和修复
