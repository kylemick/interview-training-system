# Capability: Question Bank (題庫管理)

## ADDED Requirements

### Requirement: 題目數據模型
係統SHALL定义標準化的題目數據結构，支持七大專項類別。

#### Scenario: 存储題目元數據
- **WHEN** 係統創建或導入題目
- **THEN** 每道題目包含：唯一ID、專項類別、難度等级、學校標籤、題目文本、參考答案、評分標準
- **AND** 可選字段：創建時間、來源（手動/AI生成）、使用次數、平均得分

#### Scenario: 七大專項類別定义
- **WHEN** 係統初始化題庫
- **THEN** 支持以下類別：`english-oral`（英文口語）、`chinese-oral`（中文表達）、`logic-thinking`（邏輯思維）、`current-affairs`（時事常識）、`science-knowledge`（科學常識）、`personal-growth`（个人成長）、`group-discussion`（小組討論）
- **AND** 每个類別有清晰的描述和示例題目

### Requirement: 題目錄入和導入
係統SHALL支持手動錄入和批量導入題目。

#### Scenario: 手動添加单个題目
- **WHEN** 用户通過CLI添加題目，提供類別、難度、題目文本
- **THEN** 係統验证输入（類別合法、難度在1-5范围）
- **AND** 生成唯一ID并保存到數據庫
- **AND** 返回成功消息和題目ID

#### Scenario: 批量導入JSON格式題目
- **WHEN** 用户導入包含題目數組的JSON文件
- **THEN** 係統验证每个題目的格式和必填字段
- **AND** 跳過无效題目并記錄错误
- **AND** 成功導入的題目保存到數據庫
- **AND** 返回導入統計（成功數、失敗數）

#### Scenario: 導入面試回憶文本
- **WHEN** 用户粘贴面試回憶文本（已经用外部工具转好的文字）
- **THEN** 用户標注專項類別和學校
- **AND** 可選：用户手動拆分为多个問答對，或AI辅助識別問答對
- **AND** 係統将每个問答對保存为題目（題目文本+用户的原始回答）
- **AND** 標記为"面試回憶"來源

### Requirement: 題目查询和筛選
係統SHALL提供灵活的題目查询功能。

#### Scenario: 按類別查询題目
- **WHEN** 用户查询特定類別的題目（如"english-oral"）
- **THEN** 返回该類別的所有題目列表
- **AND** 显示每題的ID、難度、简短文本预览

#### Scenario: 按學校標籤筛選
- **WHEN** 用户指定目標學校（如"SPCC"）查询題目
- **THEN** 返回標記为该學校相關或适用于该校的題目
- **AND** 優先显示该校真題或高相關題目

#### Scenario: 按難度筛選
- **WHEN** 用户指定難度范围（如"3-5"）查询題目
- **THEN** 返回難度在该范围內的題目
- **AND** 可結合類別和學校標籤進行多条件筛選

#### Scenario: 随机選題
- **WHEN** 係統需要为練習會話選擇題目
- **THEN** 根據筛選条件（類別、難度、學校）随机選擇題目
- **AND** 避免短期內重复（如最近10次會話未使用）
- **AND** 優先選擇用户表现较弱的子類別題目

### Requirement: AI生成題目
係統SHALL使用AI生成題目以扩充題庫，并支持從面試回憶中提取題目。

#### Scenario: 生成指定類別題目
- **WHEN** 用户请求生成N道指定類別的題目（如"生成15道時事常識題"）
- **THEN** 係統調用AI API，提供類別、難度、學校上下文
- **AND** AI返回題目列表（JSON格式），包含題目文本、參考答案、評分標準
- **AND** 係統验证并保存生成的題目，標注來源为"AI生成"

#### Scenario: 根據热點時事生成題目
- **WHEN** 用户请求生成時事常識題
- **THEN** 係統在提示詞中要求AI基于近期热點事件（可選：提供時事關键詞）
- **AND** AI生成与時事相關的面試題目
- **AND** 題目包含對時事的理解和个人觀點阐述要求

#### Scenario: 從面試回憶中AI提取題目
- **WHEN** 用户提交面試回憶文本并请求AI分析
- **THEN** AI識別文本中的問答對結构
- **AND** AI提取問題、學生回答、可能的面試官追問
- **AND** AI推断題目的專項類別和難度
- **AND** 将提取的題目保存到題庫，標記为"面試回憶提取"

### Requirement: 題目质量管理
係統SHALL支持題目的評價、编輯和删除。

#### Scenario: 编輯題目內容
- **WHEN** 用户發现題目有误或需要優化
- **THEN** 用户可编輯題目的任意字段（文本、難度、標籤等）
- **AND** 係統保存修改历史（修改時間、修改人）
- **AND** 已使用该題的历史會話保留原題目快照

#### Scenario: 標記題目质量
- **WHEN** 用户或係統評估題目质量
- **THEN** 可對題目標記质量標籤（優秀/良好/需改進）
- **AND** 選題時優先選擇"優秀"和"良好"題目
- **AND** "需改進"題目不自動選用，仅供手動查看和修正

#### Scenario: 删除低质量題目
- **WHEN** 用户删除題目
- **THEN** 係統標記題目为"已删除"而非物理删除
- **AND** 历史會話中的该題記錄保留但注明"題目已下架"
- **AND** 删除的題目不再出现在選題池中

### Requirement: 題目統計和分析
係統SHALL收集題目使用數據以優化題庫。

#### Scenario: 統計題目使用频率
- **WHEN** 查看題庫統計數據
- **THEN** 显示每道題的使用次數、最後使用時間
- **AND** 識別長期未使用的題目（如>30天未使用）
- **AND** 建議补充或生成新題

#### Scenario: 統計題目平均表现
- **WHEN** 題目被使用多次後
- **THEN** 計算该題的平均得分和答題時長
- **AND** 識別過難（平均分<50%）或過易（平均分>90%）的題目
- **AND** 建議調整難度標籤或題目內容
