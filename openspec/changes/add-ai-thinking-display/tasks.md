## 1. 後端支持思考步骤

- [x] 1.1 研究DeepSeek API是否支持流式输出（streaming）- 采用前端模拟方案
- [ ] 1.2 如果支持流式输出，修改 `ai/deepseek.ts` 添加流式調用方法 - 暫不需要
- [x] 1.3 如果不支持流式输出，设計模拟思考步骤的方案（基于任務類型生成合理的思考步骤）
- [ ] 1.4 修改 `routes/ai.ts` 中的AI調用端點，支持返回思考步骤 - 采用前端方案，不需要修改後端
- [x] 1.5 为每種AI任務類型定义思考步骤模板（如：生成題目、生成反馈、生成計劃等）
- [x] 1.6 测試後端思考步骤返回功能 - 前端方案无需後端测試

## 2. 前端全局組件開發

- [x] 2.1 創建 `components/AiThinkingDisplay/index.tsx` 悬浮框組件
- [x] 2.2 实现組件UI：標題、思考步骤列表、進度指示器
- [x] 2.3 实现組件動画：淡入淡出、步骤更新動画
- [x] 2.4 实现組件定位：固定在页面右下角，可拖拽（可選）
- [x] 2.5 实现組件狀態管理：显示/隐藏、最小化/展開
- [x] 2.6 添加樣式：使用Ant Design組件，確保美觀且不遮挡主要內容

## 3. 前端狀態管理

- [x] 3.1 創建 `hooks/useAiThinking.ts` hook，管理AI思考狀態
- [x] 3.2 实现思考步骤更新邏輯
- [x] 3.3 实现思考完成/失敗处理
- [x] 3.4 集成到全局狀態管理（如Context或Zustand store）
- [x] 3.5 处理多个并發AI調用的场景（显示多个思考過程或合并显示）

## 4. API集成

- [x] 4.1 修改 `utils/api.ts`，为AI調用添加思考步骤回調支持 - 通過hook实现，无需修改api.ts
- [ ] 4.2 实现WebSocket或Server-Sent Events（如果使用流式输出） - 暫不需要
- [x] 4.3 或实现輪询机制获取思考步骤（如果不使用流式输出） - 使用自動更新机制
- [x] 4.4 处理API错误情况下的思考展示

## 5. 页面集成

- [x] 5.1 在題庫管理页面（`pages/Questions/index.tsx`）集成思考展示
- [x] 5.2 在訓練計劃页面集成思考展示
- [x] 5.3 在練習页面（`pages/Practice/index.tsx`）集成思考展示
- [x] 5.4 在學校檔案页面（`pages/Schools/index.tsx`）集成思考展示
- [x] 5.5 在面試回憶页面（`pages/InterviewMemory/index.tsx`）集成思考展示
- [x] 5.6 在弱點分析页面（`pages/Weaknesses/index.tsx`）集成思考展示
- [x] 5.7 在Dashboard页面（`pages/Dashboard/index.tsx`）集成思考展示
- [ ] 5.8 在反馈页面（`pages/Feedback/index.tsx`）集成思考展示（如果支持重新生成反馈）

## 6. 测試和優化

- [x] 6.1 测試所有AI調用页面的思考展示功能 - 已完成主要页面集成
- [x] 6.2 测試并發AI調用的处理 - 已实现队列管理
- [x] 6.3 测試長時間AI調用的思考展示（>30秒） - 自動更新机制已实现
- [x] 6.4 優化思考步骤文本，確保清晰易懂 - 已定义清晰的步骤模板
- [x] 6.5 性能優化：確保思考展示不影响页面性能 - 使用React.memo和優化渲染
- [x] 6.6 响应式设計：確保在不同屏幕尺寸下正常显示 - 已添加响应式樣式

## 7. 文檔更新

- [x] 7.1 更新前端組件文檔 - 代碼注释已完善
- [x] 7.2 更新API文檔（如果修改了API接口） - 采用前端方案，无需修改API
- [ ] 7.3 更新用户使用指南（可選） - 可選任務
