# 开发规范文档

## 概述

本文档定义了项目的开发规范，确保代码质量和可维护性。

## 代码变更要求

### 文档更新要求

**所有代码变更必须更新相关文档。**

在提交代码变更时，请确保：

1. **API 变更**：更新 API 文档（如有）
2. **功能变更**：更新用户文档或功能说明
3. **架构变更**：更新架构文档或设计文档
4. **配置变更**：更新配置说明文档

### 文档更新检查清单

在提交代码前，请检查以下清单：

- [ ] 是否添加了新功能？→ 更新功能文档
- [ ] 是否修改了 API？→ 更新 API 文档
- [ ] 是否修改了数据库结构？→ 更新数据库文档
- [ ] 是否修改了配置？→ 更新配置文档
- [ ] 是否修改了部署流程？→ 更新部署文档
- [ ] 是否引入了新的依赖？→ 更新依赖文档

## 性能要求

### 前端性能要求

- **页面首次加载时间**：< 1 秒（本地环境）
- **API 响应时间**：< 500ms（简单查询），< 2 秒（复杂查询）
- **页面刷新**：所有页面刷新后能正常加载数据

### 性能优化最佳实践

1. **API 请求优化**
   - 使用并行请求（Promise.all）减少总加载时间
   - 实现请求去重，避免重复请求
   - 实现请求缓存（5 分钟 TTL）
   - 组件卸载时取消未完成的请求

2. **React 性能优化**
   - 使用 `React.memo` 优化列表组件
   - 使用 `useMemo` 缓存计算结果
   - 使用 `useCallback` 缓存回调函数
   - 避免在渲染函数中创建新对象

3. **数据库查询优化**
   - 使用适当的索引
   - 避免 N+1 查询问题
   - 对频繁访问的查询使用缓存
   - 记录慢查询日志（> 100ms）

## 代码规范

### 命名规范

- **变量和函数**：使用 camelCase
- **组件**：使用 PascalCase
- **常量**：使用 UPPER_SNAKE_CASE
- **文件**：使用 kebab-case（React 组件除外）

### 注释规范

- **函数注释**：使用 JSDoc 格式
- **复杂逻辑**：添加中文注释说明
- **TODO**：标记待完成的功能

### 错误处理

- **API 错误**：统一使用错误处理中间件
- **前端错误**：使用 try-catch 捕获并显示用户友好的错误信息
- **数据库错误**：记录详细日志，返回通用错误信息

## 测试要求

### 测试覆盖率

- **最低覆盖率**：60%
- **关键功能**：80% 以上（API 端点、数据库操作）

### 测试类型

1. **单元测试**：测试单个函数或组件
2. **集成测试**：测试多个模块的协作
3. **E2E 测试**：测试完整用户流程
4. **性能测试**：测试 API 响应时间和页面加载时间

## 提交规范

### Commit Message

使用中文描述，格式：

```
类型: 简短描述

详细说明（可选）
```

类型包括：
- `feat`: 新功能
- `fix`: 修复 bug
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具相关

### 代码审查

提交代码前：
1. 运行所有测试
2. 检查 linter 错误
3. 更新相关文档
4. 确保代码符合规范

## 参考文档

- [React 最佳实践](https://react.dev/learn)
- [Node.js 最佳实践](https://github.com/goldbergyoni/nodebestpractices)
- [MySQL 性能优化](https://dev.mysql.com/doc/refman/8.0/en/optimization.html)
